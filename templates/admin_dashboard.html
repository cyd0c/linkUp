{% extends "base.html" %}

{% block content %}
<div class="container py-5">

  <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2"><i class="bi bi-speedometer2"></i> Admin Dashboard</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
      <div class="btn-group me-2">
        <button type="button" class="btn btn-sm btn-outline-secondary">Share</button>
        <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>
      </div>
    </div>
  </div>

  <div class="row mb-4">
    <div class="col-md-4">
      <div class="card text-white bg-primary shadow">
        <div class="card-body d-flex justify-content-between align-items-center">
          <div>
            <h5 class="card-title">Pending Users</h5>
            <p class="card-text fs-2 fw-bold">{{ pending_users|length }}</p>
          </div>
          <i class="bi bi-person-clock fs-1 opacity-50"></i>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-white bg-dark shadow">
        <div class="card-body d-flex justify-content-between align-items-center">
          <div>
            <h5 class="card-title">Projects to Verify</h5>
            <p class="card-text fs-2 fw-bold">12</p> </div>
          <i class="bi bi-clipboard-check fs-1 opacity-50"></i>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-white bg-secondary shadow">
        <div class="card-body d-flex justify-content-between align-items-center">
          <div>
            <h5 class="card-title">Total Users</h5>
            <p class="card-text fs-2 fw-bold">152</p> </div>
          <i class="bi bi-people-fill fs-1 opacity-50"></i>
        </div>
      </div>
    </div>
  </div>

  <div class="row">

    <div class="col-lg-8 mb-4">
      <div class="card shadow-sm">
        <div class="card-header fw-bold">
          <i class="bi bi-person-exclamation-fill"></i> Pending User Approvals
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-hover align-middle">
              <thead>
                <tr>
                  <th scope="col">Username</th>
                  <th scope="col">Role</th>
                  <th scope="col" class="text-center">Actions</th>
                </tr>
              </thead>
              <tbody>
                {% for u in pending_users %}
                  <tr>
                    <td>{{ u.username }}</td>
                    <td>
                      {% if u.role == 'student' %}
                        <span class="badge bg-info">Freelancer</span>
                      {% elif u.role == 'client' %}
                        <span class="badge bg-warning text-dark">Client</span>
                      {% else %}
                        <span class="badge bg-secondary">{{ u.role }}</span>
                      {% endif %}
                    </td>
                    <td class="text-center">
                        <a href="{{ url_for('admin.view_user', user_id=u.id) }}" class="btn btn-sm btn-outline-primary" title="View Profile"><i class="bi bi-eye-fill"></i></a>
                        
                        <form method="post" action="{{ url_for('admin.approve_user', user_id=u.id) }}" class="d-inline">
                          <button class="btn btn-sm btn-outline-success" title="Approve"><i class="bi bi-check-circle-fill"></i></button>
                        </form>
                        
                        <form method="post" action="{{ url_for('admin.reject_user', user_id=u.id) }}" class="d-inline">
                          <button class="btn btn-sm btn-outline-danger" title="Reject"><i class="bi bi-x-circle-fill"></i></button>
                        </form>
                    </td>
                  </tr>
                {% else %}
                  <tr>
                    <td colspan="3" class="text-center text-muted">No pending users to approve.</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="col-lg-4 mb-4">
      <div class="card shadow-sm">
        <div class="card-header fw-bold">
          <i class="bi bi-tools"></i> Admin Tools
        </div>
        <div class="list-group list-group-flush">
          <a href="{{ url_for('admin.admin_verify') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
            Verify Projects
            <i class="bi bi-patch-check-fill text-primary"></i>
          </a>
          <a href="{{ url_for('admin.admin_analytics') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
            View Analytics
            <i class="bi bi-bar-chart-line-fill text-success"></i>
          </a>
          <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
            Manage Site Content
            <i class="bi bi-pencil-square text-warning"></i>
          </a>
           <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
            System Settings
            <i class="bi bi-gear-fill text-secondary"></i>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}